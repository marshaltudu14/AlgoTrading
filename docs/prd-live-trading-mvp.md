
# Product Requirements Document: Autonomous Trading Bot - Live Trading MVP

**Author:** John, Product Manager
**Status:** Draft
**Version:** 1.0
**Date:** 2025-07-18

---

## 1. Overview & Vision

### 1.1. Vision
To create a fully autonomous algorithmic trading bot that can independently analyze market data, make reasoned trading decisions, and execute trades in a live environment without manual intervention. The long-term vision is a multi-agent system that adapts to various market conditions, but the MVP will focus on proving the viability of a single, supervised model.

### 1.2. Problem Statement
Discretionary trading is time-consuming, prone to emotional errors, and requires constant market monitoring. An automated system is needed to execute a trading strategy systematically, 24/7, based on data-driven signals.

### 1.3. Goals & Objectives
- **Primary Goal:** Successfully deploy the existing supervised model into a live trading environment.
- **Objective 1:** Automate the entire trading lifecycle: data fetching, signal generation, order execution, and position management.
- **Objective 2:** Implement a robust risk management framework using ATR-based stop-loss and take-profit levels.
- **Objective 3:** Validate the profitability of the supervised model in a live or paper trading environment.

### 1.4. Scope (MVP)
This PRD covers the requirements for the **Live Trading MVP**. The scope is limited to deploying the existing single supervised model, connecting to the Fyers API for execution, and managing one active position at a time on a single instrument.

---

## 2. User Persona

- **Persona:** The Developer-Trader (Initially, the project owner)
- **Needs:**
    - A reliable, "set-and-forget" system that executes a predefined strategy.
    - Clear logging to monitor the bot's decisions and performance.
    - A straightforward way to configure key parameters like the trading timeframe.
    - Confidence that the bot's risk management is functioning as designed.

---

## 3. Features & Requirements

### 3.1. Core Trading Logic

#### FR-001: System Configuration
- The system MUST allow the user to select the operational timeframe from a predefined list: `1m, 2m, 5m, 15m`.
- The trading instrument for the MVP will be hardcoded to the Nifty Index.

#### FR-002: Signal Generation & Entry Logic
- The system MUST run on a schedule determined by the configured timeframe (e.g., every 5 minutes for the 5m chart).
- On each cycle, if there is **no active position**, the system MUST:
    1. Fetch the latest historical candle data for the Nifty Index.
    2. Process the data through the existing feature generation and reasoning pipeline.
    3. Feed the processed data into the trained supervised model to get a `signal` prediction (0 for Hold, 1 for Buy, 2 for Sell).
- If the predicted signal is `1` (Buy) or `2` (Sell), the system MUST proceed to the In-Trade Management phase.

#### FR-003: In-Trade & Risk Management
- Upon receiving an entry signal (`1` or `2`), the system MUST immediately:
    1. Calculate the Stop-Loss price (1x ATR below entry for Buy, 1x ATR above for Sell).
    2. Calculate the Target Price (2x ATR above entry for Buy, 2x ATR below for Sell).
    3. Place a market order to enter the position via the Fyers API.
- Immediately after entering the position, the system MUST:
    1. Subscribe to the Fyers WebSocket for real-time ticks of the Nifty Index.
    2. Continuously monitor incoming ticks against the calculated Stop-Loss and Target prices.
- If the real-time price hits the Stop-Loss or Target Price, the system MUST instantly place a market order to exit the position.

#### FR-004: Position Management & Exit Logic
- The system MUST only manage **one active position at a time**.
- While a position is active, the main signal generation loop (FR-002) MUST be paused.
- An active position can be closed in two ways:
    1. **Primary Exit:** The WebSocket monitor triggers an exit based on the SL/TP being hit (FR-003).
    2. **Secondary (Model-based) Exit:** If the position is still open when the next signal generation cycle runs, and the model predicts `0` (Hold) or an opposing signal, the system MUST exit the position.
- Upon closing a position, the system MUST unsubscribe from the WebSocket and resume the main signal generation loop.

### 3.2. Technical Requirements

#### FR-005: Fyers API Integration
- The system MUST securely manage Fyers API credentials.
- The system MUST implement the Fyers authentication flow to obtain a valid access token.
- The system MUST use the Fyers Python SDK for all API interactions (fetching data, placing orders, checking positions).

#### FR-006: Logging & Monitoring
- The system MUST maintain a detailed log of all major actions:
    - Initialization and configuration settings.
    - Each signal generated by the model.
    - Reasons for entering a trade.
    - Orders placed, modified, or canceled.
    - Real-time SL/TP hits from the WebSocket.
    - Reasons for exiting a trade.
    - Any errors encountered.

### 3.3. Critical Assumption
- **CA-001: Correct Signal Generation:** This entire PRD is based on the assumption that the `signal` column used for training the model is generated using a lookahead logic that correctly identifies profitable trades based on the **1:2 ATR risk/reward ratio**. The existing model MUST be retrained on this corrected data before live deployment.

---

## 4. Success Metrics

- **Metric 1: System Uptime:** The bot runs without crashing for at least 99% of market hours.
- **Metric 2: Execution Accuracy:** Orders are placed correctly, and positions are managed according to the defined logic with a >99% success rate.
- **Metric 3: Profitability (Paper/Live):** The bot achieves a positive return over a 1-month testing period.
- **Metric 4: Risk Management:** The bot successfully exits positions at the defined Stop-Loss and Take-Profit levels.

---

## 5. Future Work (Out of Scope for MVP)

- Implementing the multi-agent reinforcement learning system.
- Adding a user interface for monitoring and control.
- Supporting multiple concurrent positions and instruments.
- Advanced backtesting and performance analytics features.
