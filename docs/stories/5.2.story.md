---
id: story-template-v2
name: Story Document
version: 2.0
---

# Story 5.2: Comprehensive Backtesting Reports

## Status
Draft

## Story
**As an** RL engineer,
**I want** to generate comprehensive backtesting reports,
**so that** I can analyze the RL agent's performance in detail and identify areas for improvement.

## Acceptance Criteria
1. The `Trainer` (or a new reporting module) can generate a summary report of backtesting results.
2. The report includes all metrics from Story 5.1.
3. The report is displayed in the terminal in a clear, well-formatted, and concise manner.
4. The report highlights key performance indicators (e.g., Sharpe Ratio, Max Drawdown, Total P&L).
5. The report can be generated for both baseline PPO and MoE agents.

## Tasks / Subtasks
- [ ] Task 1 (AC: 1, 2, 3, 4, 5): Implement the backtesting report generation.
    - [ ] Subtask 1.1: Enhance the `Trainer` to generate a backtesting report.
    - [ ] Subtask 1.2: Use the functions from `src/utils/metrics.py` to calculate the performance metrics.
    - [ ] Subtask 1.3: Format the report for clear terminal output. [Source: `docs/architecture/rl-model-architecture-detailed.md#2-srctrainingtrainerpy-enhancement---comprehensive-backtesting-reports`]
- [ ] Task 2: Write an integration test for the backtesting report.
    - [ ] Subtask 2.1: Add a test case to `tests/test_training.py`.
    - [ ] Subtask 2.2: Write an integration test that runs a backtest and verifies that a report is generated with the correct metrics.

## Dev Notes
- **File Location**: `src/training/trainer.py` [Source: `docs/architecture/source-tree.md#6-source-directory-src`]
- **Responsibilities**: This story is about making the results of the backtesting easy to understand. [Source: `docs/architecture/rl-model-architecture-detailed.md#2-srctrainingtrainerpy-enhancement---comprehensive-backtesting-reports`]

### Testing
- An integration test should be added to the existing `tests/test_training.py` file.

## QA Results
